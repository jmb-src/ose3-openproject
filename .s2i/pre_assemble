#!/bin/bash

if [[ -n "${OPENPROJECT_MANAGED_REPOS}" ]]; then
    ln -snf /tmp/src/config/configuration.yml /opt/app-root/etc/configuration.yml
fi
cd /tmp/src && bundle --path bundle
# delete resulting .bundle/cache or else there is
# a conflict with /tmp/src/.bundle/config
rm -rf /opt/app-root/src/.bundle
cd /tmp/src/frontend && npm install && bower install
